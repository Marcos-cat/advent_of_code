Input ← &fras "input.txt"

Parse ← (
  ↯∞_2⊜⋕⊸∊+@0⇡10
  /◇⊂⍚(/⍜-(⇡+₁))
  ⊸(+₁⌊°ₑ₁₀)
)

Part₁ ← (
  ₑ₁₀÷₂∩⌞▽⊸(=₀◿₂)
  /+×=⊸⊃(⌊÷|◿)
)

Part₂ ← (
  ₑ₁₀ ⍚(⊚=₀◿⊸⇡) ∩↘₂ °⊏ ⊕□
  /+/◇⊂⍚(▽/↥⊸≡⌟(/×⧈=⍉⊥))
)

Digits ← +₁⌊°ₑ₁₀

Parse ← (
  ↯∞_2⊜⋕⊸∊+@0⇡10
  /◇⊂⍚⨬¤⍜°⊟(∩⊟⟜(⊸-₁⍜°ₑ₁₀⌈))⊸(≡/-Digits)
  ∩↘₂°⊏ ⊕□ ⊸(Digits≡⊢)
)

Test ← (
  ⌝⊥⊸⊃(ₑ₁₀|⍉↯⊃(÷|/⍜-(⇡+₁)⌊÷ₑ₁₀-)) °⊟
  ▽⤚(×⊓⌞≤≥⊙°⊟)
)

Part₁ ← /+◴/◇⊂⍚(/◇⊂⍚⌞Test)⍉⊟⊸÷₂∩⌞▽⊸(=₀◿₂)
Part₂ ← /+◴/◇⊂⍚(/◇⊂♭⊞(□Test)≡⊟⊸(▽=₀⤚◿⊸⇡))

⁅₅⍜now(⊃Part₁ Part₂ Parse) Input

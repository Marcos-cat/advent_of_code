Input ← &fras "input.txt"

Parse ← ⍆↯∞_2∩(⊜⋕₁₀∊⇡10⊸-@0)°$"_\n\n_"

TryCombine ← ⍥(¤⊟⊃(⊢⊢|/↥≡⊣))≤⊸⊃(⊣⊢|⊢⊣)

Part₁ ← /+/↥×⊓⌟⊞≥⊞≤°⊟⍉
Part₂ ← /++₁/-⍉ ∧⍜(↙₂↻|TryCombine) ↘₁⇌°⊏

⁅₅⍜now(⊃Part₁ Part₂ Parse) Input
